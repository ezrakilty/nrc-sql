<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Subst</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Subst</h1>

<div class="code">

<br/>
<span class="id" title="keyword">Load</span> "eztactics.v".<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.Arith.html#"><span class="id" title="library">Arith</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">LoadPath</span> "Listkit" <span class="id" title="keyword">as</span> <span class="id" title="var">Listkit</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Listkit.AllType</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Listkit.AllType</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Listkit.Foreach</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Listkit.Map</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Listkit.NthError</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Listkit.Sets</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Listkit.listkit</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="OutsideRange.html#"><span class="id" title="library">OutsideRange</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Shift.html#"><span class="id" title="library">Shift</span></a>.<br/>
<span class="id" title="keyword">Require</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#refl_equal"><span class="id" title="abbreviation">Import</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#refl_equal"><span class="id" title="abbreviation">Term</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Typing.html#"><span class="id" title="library">Typing</span></a>.<br/>

<br/>
<span class="id" title="keyword">Hint Rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>: <span class="id" title="var">map</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
Until I did all this, I didn't realize that substitution was a big
ask; a complex function with an algorithm in its own right. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">map_lia</span> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">autorewrite</span> <span class="id" title="keyword">with</span> <span class="id" title="var">map</span>; <span class="id" title="var">lia</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab8"></a><h1 class="section">Simultaneous substitution of a list of terms beginning at De Bruijn index k</h1>

</div>
<div class="code">
<span class="id" title="keyword">Fixpoint</span> <a id="subst_env" class="idref" href="#subst_env"><span class="id" title="definition">subst_env</span></a> <a id="k:1" class="idref" href="#k:1"><span class="id" title="binder">k</span></a> <a id="vs:2" class="idref" href="#vs:2"><span class="id" title="binder">vs</span></a> <a id="tm:3" class="idref" href="#tm:3"><span class="id" title="binder">tm</span></a> {<span class="id" title="keyword">struct</span> <span class="id" title="var">tm</span>} :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Subst.html#tm:3"><span class="id" title="variable">tm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">with</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Term.html#TmConst"><span class="id" title="constructor">TmConst</span></a> ⇒ <a class="idref" href="Subst.html#tm:3"><span class="id" title="variable">tm</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Term.html#TmVar"><span class="id" title="constructor">TmVar</span></a> <span class="id" title="var">x</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.Compare_dec.html#le_gt_dec"><span class="id" title="definition">le_gt_dec</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.Peano_dec.html#eq_nat_dec"><span class="id" title="abbreviation">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.Peano_dec.html#eq_nat_dec"><span class="id" title="abbreviation">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.Peano_dec.html#eq_nat_dec"><span class="id" title="abbreviation">then</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.Peano_dec.html#eq_nat_dec"><span class="id" title="abbreviation">match</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <a class="idref" href="Subst.html#vs:2"><span class="id" title="variable">vs</span></a> (<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="Subst.html#k:1"><span class="id" title="variable">k</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="Subst.html#tm:3"><span class="id" title="variable">tm</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">v</span> ⇒ <span class="id" title="var">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.Peano_dec.html#eq_nat_dec"><span class="id" title="abbreviation">else</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.Peano_dec.html#eq_nat_dec"><span class="id" title="abbreviation">tm</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.Peano_dec.html#eq_nat_dec"><span class="id" title="abbreviation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.Peano_dec.html#eq_nat_dec"><span class="id" title="abbreviation">TmPair</span></a> <span class="id" title="var">l</span> <span class="id" title="var">m</span> ⇒ <a class="idref" href="Term.html#TmPair"><span class="id" title="constructor">TmPair</span></a> (<a class="idref" href="Subst.html#subst_env:4"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k:1"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#vs:2"><span class="id" title="variable">vs</span></a> <span class="id" title="var">l</span>) (<a class="idref" href="Subst.html#subst_env:4"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k:1"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#vs:2"><span class="id" title="variable">vs</span></a> <span class="id" title="var">m</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Term.html#TmProj"><span class="id" title="constructor">TmProj</span></a> <span class="id" title="var">b</span> <span class="id" title="var">m</span> ⇒ <a class="idref" href="Term.html#TmProj"><span class="id" title="constructor">TmProj</span></a> <span class="id" title="var">b</span> (<a class="idref" href="Subst.html#subst_env:4"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k:1"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#vs:2"><span class="id" title="variable">vs</span></a> <span class="id" title="var">m</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Term.html#TmApp"><span class="id" title="constructor">TmApp</span></a> <span class="id" title="var">l</span> <span class="id" title="var">m</span> ⇒ <a class="idref" href="Term.html#TmApp"><span class="id" title="constructor">TmApp</span></a> (<a class="idref" href="Subst.html#subst_env:4"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k:1"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#vs:2"><span class="id" title="variable">vs</span></a> <span class="id" title="var">l</span>) (<a class="idref" href="Subst.html#subst_env:4"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k:1"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#vs:2"><span class="id" title="variable">vs</span></a> <span class="id" title="var">m</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Term.html#TmAbs"><span class="id" title="constructor">TmAbs</span></a> <span class="id" title="var">n</span> ⇒ <a class="idref" href="Term.html#TmAbs"><span class="id" title="constructor">TmAbs</span></a> (<a class="idref" href="Subst.html#subst_env:4"><span class="id" title="definition">subst_env</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Subst.html#k:1"><span class="id" title="variable">k</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="Shift.html#shift"><span class="id" title="definition">shift</span></a> 0 1) <a class="idref" href="Subst.html#vs:2"><span class="id" title="variable">vs</span></a>) <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Term.html#TmNull"><span class="id" title="constructor">TmNull</span></a> ⇒ <a class="idref" href="Term.html#TmNull"><span class="id" title="constructor">TmNull</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Term.html#TmSingle"><span class="id" title="constructor">TmSingle</span></a> <span class="id" title="var">m</span> ⇒ <a class="idref" href="Term.html#TmSingle"><span class="id" title="constructor">TmSingle</span></a> (<a class="idref" href="Subst.html#subst_env:4"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k:1"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#vs:2"><span class="id" title="variable">vs</span></a> <span class="id" title="var">m</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Term.html#TmUnion"><span class="id" title="constructor">TmUnion</span></a> <span class="id" title="var">m</span> <span class="id" title="var">n</span> ⇒ <a class="idref" href="Term.html#TmUnion"><span class="id" title="constructor">TmUnion</span></a> (<a class="idref" href="Subst.html#subst_env:4"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k:1"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#vs:2"><span class="id" title="variable">vs</span></a> <span class="id" title="var">m</span>) (<a class="idref" href="Subst.html#subst_env:4"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k:1"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#vs:2"><span class="id" title="variable">vs</span></a> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Term.html#TmBind"><span class="id" title="constructor">TmBind</span></a> <span class="id" title="var">m</span> <span class="id" title="var">K</span> ⇒ <a class="idref" href="Term.html#TmBind"><span class="id" title="constructor">TmBind</span></a> (<a class="idref" href="Subst.html#subst_env:4"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k:1"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#vs:2"><span class="id" title="variable">vs</span></a> <span class="id" title="var">m</span>) (<a class="idref" href="Subst.html#subst_env:4"><span class="id" title="definition">subst_env</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Subst.html#k:1"><span class="id" title="variable">k</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="Shift.html#shift"><span class="id" title="definition">shift</span></a> 0 1) <a class="idref" href="Subst.html#vs:2"><span class="id" title="variable">vs</span></a>) <span class="id" title="var">K</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Term.html#TmIf"><span class="id" title="constructor">TmIf</span></a> <span class="id" title="var">b</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> ⇒ <a class="idref" href="Term.html#TmIf"><span class="id" title="constructor">TmIf</span></a> (<a class="idref" href="Subst.html#subst_env:4"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k:1"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#vs:2"><span class="id" title="variable">vs</span></a> <span class="id" title="var">b</span>) (<a class="idref" href="Subst.html#subst_env:4"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k:1"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#vs:2"><span class="id" title="variable">vs</span></a> <span class="id" title="var">m</span>) (<a class="idref" href="Subst.html#subst_env:4"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k:1"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#vs:2"><span class="id" title="variable">vs</span></a> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Term.html#TmTable"><span class="id" title="constructor">TmTable</span></a> <span class="id" title="var">ty</span> ⇒ <a class="idref" href="Subst.html#tm:3"><span class="id" title="variable">tm</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="subst_env_nonfree_noop" class="idref" href="#subst_env_nonfree_noop"><span class="id" title="lemma">subst_env_nonfree_noop</span></a>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="N:6" class="idref" href="#N:6"><span class="id" title="binder">N</span></a> <a id="T:7" class="idref" href="#T:7"><span class="id" title="binder">T</span></a> <a id="env:8" class="idref" href="#env:8"><span class="id" title="binder">env</span></a> <a id="Vs:9" class="idref" href="#Vs:9"><span class="id" title="binder">Vs</span></a> <a id="n:10" class="idref" href="#n:10"><span class="id" title="binder">n</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Term.html#Typing"><span class="id" title="inductive">Typing</span></a> <a class="idref" href="Subst.html#env:8"><span class="id" title="variable">env</span></a> <a class="idref" href="Subst.html#N:6"><span class="id" title="variable">N</span></a> <a class="idref" href="Subst.html#T:7"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subst.html#n:10"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#73030c22bc0b1fa771c65aa5414c65f9"><span class="id" title="notation">≥</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Subst.html#env:8"><span class="id" title="variable">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#n:10"><span class="id" title="variable">n</span></a> <a class="idref" href="Subst.html#Vs:9"><span class="id" title="variable">Vs</span></a> <a class="idref" href="Subst.html#N:6"><span class="id" title="variable">N</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Subst.html#N:6"><span class="id" title="variable">N</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="subst_env_closed_noop" class="idref" href="#subst_env_closed_noop"><span class="id" title="lemma">subst_env_closed_noop</span></a>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="N:11" class="idref" href="#N:11"><span class="id" title="binder">N</span></a> <a id="T:12" class="idref" href="#T:12"><span class="id" title="binder">T</span></a> <a id="Vs:13" class="idref" href="#Vs:13"><span class="id" title="binder">Vs</span></a> <a id="n:14" class="idref" href="#n:14"><span class="id" title="binder">n</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Term.html#Typing"><span class="id" title="inductive">Typing</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="Subst.html#N:11"><span class="id" title="variable">N</span></a> <a class="idref" href="Subst.html#T:12"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#n:14"><span class="id" title="variable">n</span></a> <a class="idref" href="Subst.html#Vs:13"><span class="id" title="variable">Vs</span></a> <a class="idref" href="Subst.html#N:11"><span class="id" title="variable">N</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Subst.html#N:11"><span class="id" title="variable">N</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="subst_env_preserves_typing_var" class="idref" href="#subst_env_preserves_typing_var"><span class="id" title="lemma">subst_env_preserves_typing_var</span></a>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="x:15" class="idref" href="#x:15"><span class="id" title="binder">x</span></a> <a id="Vs:16" class="idref" href="#Vs:16"><span class="id" title="binder">Vs</span></a> <a id="env:17" class="idref" href="#env:17"><span class="id" title="binder">env</span></a> <a id="env':18" class="idref" href="#env':18"><span class="id" title="binder">env'</span></a> <a id="T:19" class="idref" href="#T:19"><span class="id" title="binder">T</span></a> <a id="k:20" class="idref" href="#k:20"><span class="id" title="binder">k</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Term.html#env_typing"><span class="id" title="definition">env_typing</span></a> <a class="idref" href="Subst.html#Vs:16"><span class="id" title="variable">Vs</span></a> <a class="idref" href="Subst.html#env':18"><span class="id" title="variable">env'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Term.html#Typing"><span class="id" title="inductive">Typing</span></a> (<a class="idref" href="Subst.html#env:17"><span class="id" title="variable">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="Subst.html#env':18"><span class="id" title="variable">env'</span></a>) (<a class="idref" href="Term.html#TmVar"><span class="id" title="constructor">TmVar</span></a> <a class="idref" href="Subst.html#x:15"><span class="id" title="variable">x</span></a>) <a class="idref" href="Subst.html#T:19"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subst.html#k:20"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Subst.html#env:17"><span class="id" title="variable">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Term.html#Typing"><span class="id" title="inductive">Typing</span></a> <a class="idref" href="Subst.html#env:17"><span class="id" title="variable">env</span></a> (<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k:20"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#Vs:16"><span class="id" title="variable">Vs</span></a> (<a class="idref" href="Term.html#TmVar"><span class="id" title="constructor">TmVar</span></a> <a class="idref" href="Subst.html#x:15"><span class="id" title="variable">x</span></a>)) <a class="idref" href="Subst.html#T:19"><span class="id" title="variable">T</span></a>.<br/>

<br/>
</div>

<div class="doc">
       Vs :: env'
env, env' |- M       : T
env       |- M{Vs/k} : T    (where k = length env)

</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="subst_env_preserves_typing" class="idref" href="#subst_env_preserves_typing"><span class="id" title="lemma">subst_env_preserves_typing</span></a>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="M:21" class="idref" href="#M:21"><span class="id" title="binder">M</span></a> <a id="Vs:22" class="idref" href="#Vs:22"><span class="id" title="binder">Vs</span></a> <a id="env:23" class="idref" href="#env:23"><span class="id" title="binder">env</span></a> <a id="env':24" class="idref" href="#env':24"><span class="id" title="binder">env'</span></a> <a id="T:25" class="idref" href="#T:25"><span class="id" title="binder">T</span></a> <a id="k:26" class="idref" href="#k:26"><span class="id" title="binder">k</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Term.html#env_typing"><span class="id" title="definition">env_typing</span></a> <a class="idref" href="Subst.html#Vs:22"><span class="id" title="variable">Vs</span></a> <a class="idref" href="Subst.html#env':24"><span class="id" title="variable">env'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Term.html#Typing"><span class="id" title="inductive">Typing</span></a> (<a class="idref" href="Subst.html#env:23"><span class="id" title="variable">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="Subst.html#env':24"><span class="id" title="variable">env'</span></a>) <a class="idref" href="Subst.html#M:21"><span class="id" title="variable">M</span></a> <a class="idref" href="Subst.html#T:25"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subst.html#k:26"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Subst.html#env:23"><span class="id" title="variable">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Term.html#Typing"><span class="id" title="inductive">Typing</span></a> <a class="idref" href="Subst.html#env:23"><span class="id" title="variable">env</span></a> (<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k:26"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#Vs:22"><span class="id" title="variable">Vs</span></a> <a class="idref" href="Subst.html#M:21"><span class="id" title="variable">M</span></a>) <a class="idref" href="Subst.html#T:25"><span class="id" title="variable">T</span></a>.<br/>

<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Resolve</span> <span class="id" title="var">subst_env_preserves_typing</span> : <span class="id" title="var">Subst</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="subst_nil" class="idref" href="#subst_nil"><span class="id" title="lemma">subst_nil</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="N:27" class="idref" href="#N:27"><span class="id" title="binder">N</span></a> <a id="k:28" class="idref" href="#k:28"><span class="id" title="binder">k</span></a>, <a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k:28"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="Subst.html#N:27"><span class="id" title="variable">N</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Subst.html#N:27"><span class="id" title="variable">N</span></a>.<br/>

<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Resolve</span> <span class="id" title="var">subst_nil</span>  : <span class="id" title="var">Subst</span>.<br/>

<br/>
</div>

<div class="doc">
If a variable is bigger than <span class="inlinecode"><span class="id" title="var">q</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">length</span></span> <span class="inlinecode"><span class="id" title="var">env</span></span> then it is untouched
 by substituting (<span class="inlinecode"><span class="id" title="var">q</span></span>, <span class="inlinecode"><span class="id" title="var">env</span></span>). 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="subst_env_big_var" class="idref" href="#subst_env_big_var"><span class="id" title="lemma">subst_env_big_var</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="q:29" class="idref" href="#q:29"><span class="id" title="binder">q</span></a> <a id="x:30" class="idref" href="#x:30"><span class="id" title="binder">x</span></a> <a id="env:31" class="idref" href="#env:31"><span class="id" title="binder">env</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subst.html#q:29"><span class="id" title="variable">q</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Subst.html#env:31"><span class="id" title="variable">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="Subst.html#x:30"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#q:29"><span class="id" title="variable">q</span></a> <a class="idref" href="Subst.html#env:31"><span class="id" title="variable">env</span></a> (<a class="idref" href="Term.html#TmVar"><span class="id" title="constructor">TmVar</span></a> <a class="idref" href="Subst.html#x:30"><span class="id" title="variable">x</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Term.html#TmVar"><span class="id" title="constructor">TmVar</span></a> <a class="idref" href="Subst.html#x:30"><span class="id" title="variable">x</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="shift_subst_commute_hi" class="idref" href="#shift_subst_commute_hi"><span class="id" title="lemma">shift_subst_commute_hi</span></a>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="M:32" class="idref" href="#M:32"><span class="id" title="binder">M</span></a> <a id="env:33" class="idref" href="#env:33"><span class="id" title="binder">env</span></a> <a id="k:34" class="idref" href="#k:34"><span class="id" title="binder">k</span></a> <a id="q:35" class="idref" href="#q:35"><span class="id" title="binder">q</span></a> <a id="n:36" class="idref" href="#n:36"><span class="id" title="binder">n</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subst.html#q:35"><span class="id" title="variable">q</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Subst.html#env:33"><span class="id" title="variable">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="Subst.html#k:34"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Shift.html#shift"><span class="id" title="definition">shift</span></a> <a class="idref" href="Subst.html#k:34"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#n:36"><span class="id" title="variable">n</span></a> (<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#q:35"><span class="id" title="variable">q</span></a> <a class="idref" href="Subst.html#env:33"><span class="id" title="variable">env</span></a> <a class="idref" href="Subst.html#M:32"><span class="id" title="variable">M</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#q:35"><span class="id" title="variable">q</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="Shift.html#shift"><span class="id" title="definition">shift</span></a> <a class="idref" href="Subst.html#k:34"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#n:36"><span class="id" title="variable">n</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.Compare_dec.html#le_gt_dec"><span class="id" title="definition">env</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.Compare_dec.html#le_gt_dec"><span class="id" title="definition">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.Compare_dec.html#le_gt_dec"><span class="id" title="definition">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.Compare_dec.html#le_gt_dec"><span class="id" title="definition">shift</span></a> <a class="idref" href="Subst.html#k:34"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#n:36"><span class="id" title="variable">n</span></a> <a class="idref" href="Subst.html#M:32"><span class="id" title="variable">M</span></a>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="shift_subst_commute_lo" class="idref" href="#shift_subst_commute_lo"><span class="id" title="lemma">shift_subst_commute_lo</span></a>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="M:37" class="idref" href="#M:37"><span class="id" title="binder">M</span></a> <a id="env:38" class="idref" href="#env:38"><span class="id" title="binder">env</span></a> <a id="k:39" class="idref" href="#k:39"><span class="id" title="binder">k</span></a> <a id="q:40" class="idref" href="#q:40"><span class="id" title="binder">q</span></a> <a id="n:41" class="idref" href="#n:41"><span class="id" title="binder">n</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subst.html#k:39"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="Subst.html#q:40"><span class="id" title="variable">q</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Shift.html#shift"><span class="id" title="definition">shift</span></a> <a class="idref" href="Subst.html#k:39"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#n:41"><span class="id" title="variable">n</span></a> (<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#q:40"><span class="id" title="variable">q</span></a> <a class="idref" href="Subst.html#env:38"><span class="id" title="variable">env</span></a> <a class="idref" href="Subst.html#M:37"><span class="id" title="variable">M</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> (<a class="idref" href="Subst.html#q:40"><span class="id" title="variable">q</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="Subst.html#n:41"><span class="id" title="variable">n</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="Shift.html#shift"><span class="id" title="definition">shift</span></a> <a class="idref" href="Subst.html#k:39"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#n:41"><span class="id" title="variable">n</span></a>) <a class="idref" href="Subst.html#env:38"><span class="id" title="variable">env</span></a>) (<a class="idref" href="Shift.html#shift"><span class="id" title="definition">shift</span></a> <a class="idref" href="Subst.html#k:39"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#n:41"><span class="id" title="variable">n</span></a> <a class="idref" href="Subst.html#M:37"><span class="id" title="variable">M</span></a>).<br/>

<br/>
</div>

<div class="doc">
If two successive substitutions are "independent" and adjacent then we can combine
   them into one (on a var). 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="subst_env_concat_TmVar" class="idref" href="#subst_env_concat_TmVar"><span class="id" title="lemma">subst_env_concat_TmVar</span></a>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="x:42" class="idref" href="#x:42"><span class="id" title="binder">x</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="Vs:43" class="idref" href="#Vs:43"><span class="id" title="binder">Vs</span></a> <a id="Ws:44" class="idref" href="#Ws:44"><span class="id" title="binder">Ws</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Term.html#Term"><span class="id" title="inductive">Term</span></a>) (<a id="env:45" class="idref" href="#env:45"><span class="id" title="binder">env</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Term.html#Ty"><span class="id" title="inductive">Ty</span></a>) (<a id="k:46" class="idref" href="#k:46"><span class="id" title="binder">k</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Term.html#env_typing"><span class="id" title="definition">env_typing</span></a> (<a class="idref" href="Subst.html#Vs:43"><span class="id" title="variable">Vs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="Subst.html#Ws:44"><span class="id" title="variable">Ws</span></a>) <a class="idref" href="Subst.html#env:45"><span class="id" title="variable">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="Subst.html#Vs:43"><span class="id" title="variable">Vs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="Subst.html#Ws:44"><span class="id" title="variable">Ws</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Subst.html#env:45"><span class="id" title="variable">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k:46"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#Vs:43"><span class="id" title="variable">Vs</span></a> (<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> (<a class="idref" href="Subst.html#k:46"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Subst.html#Vs:43"><span class="id" title="variable">Vs</span></a>) <a class="idref" href="Subst.html#Ws:44"><span class="id" title="variable">Ws</span></a> (<a class="idref" href="Term.html#TmVar"><span class="id" title="constructor">TmVar</span></a> <a class="idref" href="Subst.html#x:42"><span class="id" title="variable">x</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k:46"><span class="id" title="variable">k</span></a> (<a class="idref" href="Subst.html#Vs:43"><span class="id" title="variable">Vs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="Subst.html#Ws:44"><span class="id" title="variable">Ws</span></a>) (<a class="idref" href="Term.html#TmVar"><span class="id" title="constructor">TmVar</span></a> <a class="idref" href="Subst.html#x:42"><span class="id" title="variable">x</span></a>).<br/>

<br/>
</div>

<div class="doc">
If two successive substitutions are "independent" and adjacent then we can combine
   them into one. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="subst_env_concat" class="idref" href="#subst_env_concat"><span class="id" title="lemma">subst_env_concat</span></a>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="N:47" class="idref" href="#N:47"><span class="id" title="binder">N</span></a> <a id="Vs:48" class="idref" href="#Vs:48"><span class="id" title="binder">Vs</span></a> <a id="Ws:49" class="idref" href="#Ws:49"><span class="id" title="binder">Ws</span></a> <a id="env:50" class="idref" href="#env:50"><span class="id" title="binder">env</span></a> <a id="k:51" class="idref" href="#k:51"><span class="id" title="binder">k</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Term.html#env_typing"><span class="id" title="definition">env_typing</span></a> (<a class="idref" href="Subst.html#Vs:48"><span class="id" title="variable">Vs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="Subst.html#Ws:49"><span class="id" title="variable">Ws</span></a>) <a class="idref" href="Subst.html#env:50"><span class="id" title="variable">env</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="k':52" class="idref" href="#k':52"><span class="id" title="binder">k'</span></a> := <a class="idref" href="Subst.html#k:51"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Subst.html#Vs:48"><span class="id" title="variable">Vs</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="VWs:53" class="idref" href="#VWs:53"><span class="id" title="binder">VWs</span></a> := <a class="idref" href="Subst.html#Vs:48"><span class="id" title="variable">Vs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="Subst.html#Ws:49"><span class="id" title="variable">Ws</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k:51"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#Vs:48"><span class="id" title="variable">Vs</span></a> (<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k':52"><span class="id" title="variable">k'</span></a> <a class="idref" href="Subst.html#Ws:49"><span class="id" title="variable">Ws</span></a> <a class="idref" href="Subst.html#N:47"><span class="id" title="variable">N</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k:51"><span class="id" title="variable">k</span></a> (<a class="idref" href="Subst.html#VWs:53"><span class="id" title="variable">VWs</span></a>) <a class="idref" href="Subst.html#N:47"><span class="id" title="variable">N</span></a>.<br/>

<br/>
</div>

<div class="doc">
Shifting creates a term with a "dummy" (unused) variable;
    substituting at that variable has no effect, so we can drop it off
    the environment for substitution. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="subst_dummyvar" class="idref" href="#subst_dummyvar"><span class="id" title="lemma">subst_dummyvar</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="N:54" class="idref" href="#N:54"><span class="id" title="binder">N</span></a> <a id="h:55" class="idref" href="#h:55"><span class="id" title="binder">h</span></a> <a id="t:56" class="idref" href="#t:56"><span class="id" title="binder">t</span></a> <a id="k:57" class="idref" href="#k:57"><span class="id" title="binder">k</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#k:57"><span class="id" title="variable">k</span></a> (<a class="idref" href="Subst.html#h:55"><span class="id" title="variable">h</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><a class="idref" href="Subst.html#t:56"><span class="id" title="variable">t</span></a>) (<a class="idref" href="Shift.html#shift"><span class="id" title="definition">shift</span></a> <a class="idref" href="Subst.html#k:57"><span class="id" title="variable">k</span></a> 1 <a class="idref" href="Subst.html#N:54"><span class="id" title="variable">N</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Subst.html#k:57"><span class="id" title="variable">k</span></a>) <a class="idref" href="Subst.html#t:56"><span class="id" title="variable">t</span></a> (<a class="idref" href="Shift.html#shift"><span class="id" title="definition">shift</span></a> <a class="idref" href="Subst.html#k:57"><span class="id" title="variable">k</span></a> 1 <a class="idref" href="Subst.html#N:54"><span class="id" title="variable">N</span></a>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="subst_var_outside_range" class="idref" href="#subst_var_outside_range"><span class="id" title="lemma">subst_var_outside_range</span></a>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="q:58" class="idref" href="#q:58"><span class="id" title="binder">q</span></a> <a id="env:59" class="idref" href="#env:59"><span class="id" title="binder">env</span></a> <a id="x:60" class="idref" href="#x:60"><span class="id" title="binder">x</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="OutsideRange.html#outside_range"><span class="id" title="definition">outside_range</span></a> <a class="idref" href="Subst.html#q:58"><span class="id" title="variable">q</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Subst.html#env:59"><span class="id" title="variable">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="Subst.html#q:58"><span class="id" title="variable">q</span></a>) <a class="idref" href="Subst.html#x:60"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#q:58"><span class="id" title="variable">q</span></a> <a class="idref" href="Subst.html#env:59"><span class="id" title="variable">env</span></a> (<a class="idref" href="Term.html#TmVar"><span class="id" title="constructor">TmVar</span></a> <a class="idref" href="Subst.html#x:60"><span class="id" title="variable">x</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Term.html#TmVar"><span class="id" title="constructor">TmVar</span></a> <a class="idref" href="Subst.html#x:60"><span class="id" title="variable">x</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="subst_var_inside_range" class="idref" href="#subst_var_inside_range"><span class="id" title="lemma">subst_var_inside_range</span></a>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="q:61" class="idref" href="#q:61"><span class="id" title="binder">q</span></a> <a id="env:62" class="idref" href="#env:62"><span class="id" title="binder">env</span></a> <a id="x:63" class="idref" href="#x:63"><span class="id" title="binder">x</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="OutsideRange.html#outside_range"><span class="id" title="definition">outside_range</span></a> <a class="idref" href="Subst.html#q:61"><span class="id" title="variable">q</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Subst.html#env:62"><span class="id" title="variable">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="Subst.html#q:61"><span class="id" title="variable">q</span></a>) <a class="idref" href="Subst.html#x:63"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="X:64" class="idref" href="#X:64"><span class="id" title="binder">X</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Specif.html#value"><span class="id" title="definition">value</span></a> <a class="idref" href="Subst.html#X:64"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <a class="idref" href="Subst.html#env:62"><span class="id" title="variable">env</span></a> (<a class="idref" href="Subst.html#x:63"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="Subst.html#q:61"><span class="id" title="variable">q</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#q:61"><span class="id" title="variable">q</span></a> <a class="idref" href="Subst.html#env:62"><span class="id" title="variable">env</span></a> (<a class="idref" href="Term.html#TmVar"><span class="id" title="constructor">TmVar</span></a> <a class="idref" href="Subst.html#x:63"><span class="id" title="variable">x</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Subst.html#X:64"><span class="id" title="variable">X</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="set_remove" class="idref" href="#set_remove"><span class="id" title="definition">set_remove</span></a> := <span class="id" title="definition">Listkit.Sets.set_remove</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">unshift</span></span> <span class="inlinecode"><span class="id" title="var">q</span></span> <span class="inlinecode"><span class="id" title="var">k</span></span> commutes with subst, if we offset the environment by
    <span class="inlinecode"><span class="id" title="var">k</span></span> and <span class="inlinecode"><span class="id" title="var">shift</span></span> <span class="inlinecode"><span class="id" title="var">q</span></span> <span class="inlinecode"><span class="id" title="var">k</span></span> all its terms.

<div class="paragraph"> </div>

    TODO: Consider making this use outside_range.

</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="subst_unshift" class="idref" href="#subst_unshift"><span class="id" title="lemma">subst_unshift</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="M:65" class="idref" href="#M:65"><span class="id" title="binder">M</span></a> <a id="env:66" class="idref" href="#env:66"><span class="id" title="binder">env</span></a> <a id="q:67" class="idref" href="#q:67"><span class="id" title="binder">q</span></a> <a id="k:68" class="idref" href="#k:68"><span class="id" title="binder">k</span></a> <a id="n:69" class="idref" href="#n:69"><span class="id" title="binder">n</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subst.html#q:67"><span class="id" title="variable">q</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="Subst.html#n:69"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">all_Type</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.Peano_dec.html#eq_nat_dec"><span class="id" title="abbreviation">eq_nat_dec</span></a> (<span class="id" title="keyword">fun</span> <a id="x:70" class="idref" href="#x:70"><span class="id" title="binder">x</span></a> ⇒ <a class="idref" href="OutsideRange.html#Outside_Range"><span class="id" title="definition">Outside_Range</span></a> <a class="idref" href="Subst.html#q:67"><span class="id" title="variable">q</span></a> (<a class="idref" href="Subst.html#k:68"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="Subst.html#q:67"><span class="id" title="variable">q</span></a>) <a class="idref" href="Subst.html#x:70"><span class="id" title="variable">x</span></a>) (<a class="idref" href="Term.html#freevars"><span class="id" title="definition">freevars</span></a> <a class="idref" href="Subst.html#M:65"><span class="id" title="variable">M</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#n:69"><span class="id" title="variable">n</span></a> <a class="idref" href="Subst.html#env:66"><span class="id" title="variable">env</span></a> (<a class="idref" href="Shift.html#unshift"><span class="id" title="definition">unshift</span></a> <a class="idref" href="Subst.html#q:67"><span class="id" title="variable">q</span></a> <a class="idref" href="Subst.html#k:68"><span class="id" title="variable">k</span></a> <a class="idref" href="Subst.html#M:65"><span class="id" title="variable">M</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Shift.html#unshift"><span class="id" title="definition">unshift</span></a> <a class="idref" href="Subst.html#q:67"><span class="id" title="variable">q</span></a> <a class="idref" href="Subst.html#k:68"><span class="id" title="variable">k</span></a> (<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> (<a class="idref" href="Subst.html#n:69"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="Subst.html#k:68"><span class="id" title="variable">k</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="Shift.html#shift"><span class="id" title="definition">shift</span></a> <a class="idref" href="Subst.html#q:67"><span class="id" title="variable">q</span></a> <a class="idref" href="Subst.html#k:68"><span class="id" title="variable">k</span></a>) <a class="idref" href="Subst.html#env:66"><span class="id" title="variable">env</span></a>) <a class="idref" href="Subst.html#M:65"><span class="id" title="variable">M</span></a>).<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">Setoid</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="union_distrib" class="idref" href="#union_distrib"><span class="id" title="lemma">union_distrib</span></a>: <span class="id" title="keyword">∀</span> <a id="A:75" class="idref" href="#A:75"><span class="id" title="binder">A</span></a> <a id="B:76" class="idref" href="#B:76"><span class="id" title="binder">B</span></a> <a id="C:77" class="idref" href="#C:77"><span class="id" title="binder">C</span></a>, <span class="id" title="definition">eq_sets</span> <span class="id" title="var">_</span> (<a class="idref" href="Subst.html#A:75"><span class="id" title="variable">A</span></a> <span class="id" title="notation">∪</span> <span class="id" title="notation">(</span><a class="idref" href="Subst.html#B:76"><span class="id" title="variable">B</span></a> <span class="id" title="notation">∪</span> <a class="idref" href="Subst.html#C:77"><span class="id" title="variable">C</span></a><span class="id" title="notation">)</span>) (<span class="id" title="notation">(</span><a class="idref" href="Subst.html#A:75"><span class="id" title="variable">A</span></a> <span class="id" title="notation">∪</span> <a class="idref" href="Subst.html#B:76"><span class="id" title="variable">B</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∪</span> <span class="id" title="notation">(</span><a class="idref" href="Subst.html#A:75"><span class="id" title="variable">A</span></a> <span class="id" title="notation">∪</span> <a class="idref" href="Subst.html#C:77"><span class="id" title="variable">C</span></a><span class="id" title="notation">)</span>).<br/>

<br/>
</div>

<div class="doc">
After making a substitution, the freevars of the result is:
<ul class="doclist">
<li> the freevars of the original term,

</li>
<li> less the range of variables we replaced

</li>
<li> union the freevars of all the substituted terms.

</li>
</ul>
 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="subst_Freevars" class="idref" href="#subst_Freevars"><span class="id" title="lemma">subst_Freevars</span></a>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="M:78" class="idref" href="#M:78"><span class="id" title="binder">M</span></a> <a id="env:79" class="idref" href="#env:79"><span class="id" title="binder">env</span></a> <a id="q:80" class="idref" href="#q:80"><span class="id" title="binder">q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">incl_sets</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Term.html#freevars"><span class="id" title="definition">freevars</span></a> (<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#q:80"><span class="id" title="variable">q</span></a> <a class="idref" href="Subst.html#env:79"><span class="id" title="variable">env</span></a> <a class="idref" href="Subst.html#M:78"><span class="id" title="variable">M</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Lists.ListSet.html#set_union"><span class="id" title="definition">set_union</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.Peano_dec.html#eq_nat_dec"><span class="id" title="abbreviation">eq_nat_dec</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="definition">set_unions</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.Peano_dec.html#eq_nat_dec"><span class="id" title="abbreviation">eq_nat_dec</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="Term.html#freevars"><span class="id" title="definition">freevars</span></a> <a class="idref" href="Subst.html#env:79"><span class="id" title="variable">env</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="definition">set_filter</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> (<span class="id" title="keyword">fun</span> <a id="x:81" class="idref" href="#x:81"><span class="id" title="binder">x</span></a> ⇒ <a class="idref" href="OutsideRange.html#outside_range"><span class="id" title="definition">outside_range</span></a> <a class="idref" href="Subst.html#q:80"><span class="id" title="variable">q</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Subst.html#env:79"><span class="id" title="variable">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="Subst.html#q:80"><span class="id" title="variable">q</span></a>) <a class="idref" href="Subst.html#x:81"><span class="id" title="variable">x</span></a>) (<a class="idref" href="Term.html#freevars"><span class="id" title="definition">freevars</span></a> <a class="idref" href="Subst.html#M:78"><span class="id" title="variable">M</span></a>))).<br/>
&nbsp;<span class="id" title="keyword">Notation</span> <a id="db79eb3062cfc9024d8dda07dffe69e9" class="idref" href="#db79eb3062cfc9024d8dda07dffe69e9"><span class="id" title="notation">&quot;</span></a>A ⊆ B" := (<span class="id" title="definition">incl_sets</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100).<br/>
&nbsp;<span class="id" title="keyword">Notation</span> <a id="48fba6423fe32d06251435b32e600bee" class="idref" href="#48fba6423fe32d06251435b32e600bee"><span class="id" title="notation">&quot;</span></a>A % x" := (<a class="idref" href="Term.html#set_remove"><span class="id" title="definition">Term.set_remove</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.Peano_dec.html#eq_nat_dec"><span class="id" title="abbreviation">eq_nat_dec</span></a> <span class="id" title="var">x</span> <span class="id" title="var">A</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="subst_unused_noop" class="idref" href="#subst_unused_noop"><span class="id" title="lemma">subst_unused_noop</span></a>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="M:94" class="idref" href="#M:94"><span class="id" title="binder">M</span></a> <a id="env:95" class="idref" href="#env:95"><span class="id" title="binder">env</span></a> <a id="n:96" class="idref" href="#n:96"><span class="id" title="binder">n</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">all</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> (<span class="id" title="keyword">fun</span> <a id="x:97" class="idref" href="#x:97"><span class="id" title="binder">x</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#not"><span class="id" title="definition">not</span></a> (<a class="idref" href="Term.html#in_env_domain"><span class="id" title="definition">in_env_domain</span></a> <a class="idref" href="Subst.html#n:96"><span class="id" title="variable">n</span></a> <a class="idref" href="Subst.html#env:95"><span class="id" title="variable">env</span></a> <a class="idref" href="Subst.html#x:97"><span class="id" title="variable">x</span></a>)) (<a class="idref" href="Term.html#freevars"><span class="id" title="definition">freevars</span></a> <a class="idref" href="Subst.html#M:94"><span class="id" title="variable">M</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#n:96"><span class="id" title="variable">n</span></a> <a class="idref" href="Subst.html#env:95"><span class="id" title="variable">env</span></a> <a class="idref" href="Subst.html#M:94"><span class="id" title="variable">M</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Subst.html#M:94"><span class="id" title="variable">M</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="subst_factor" class="idref" href="#subst_factor"><span class="id" title="lemma">subst_factor</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="N:98" class="idref" href="#N:98"><span class="id" title="binder">N</span></a> <a id="m:99" class="idref" href="#m:99"><span class="id" title="binder">m</span></a> <a id="n:100" class="idref" href="#n:100"><span class="id" title="binder">n</span></a> <a id="env:101" class="idref" href="#env:101"><span class="id" title="binder">env</span></a> <a id="env':102" class="idref" href="#env':102"><span class="id" title="binder">env'</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">all</span> <span class="id" title="var">_</span> (<span class="id" title="keyword">fun</span> <a id="z:103" class="idref" href="#z:103"><span class="id" title="binder">z</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">all</span> <span class="id" title="var">_</span> (<span class="id" title="keyword">fun</span> <a id="x:104" class="idref" href="#x:104"><span class="id" title="binder">x</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#not"><span class="id" title="definition">not</span></a> (<a class="idref" href="Term.html#in_env_domain"><span class="id" title="definition">in_env_domain</span></a> <a class="idref" href="Subst.html#m:99"><span class="id" title="variable">m</span></a> <a class="idref" href="Subst.html#env':102"><span class="id" title="variable">env'</span></a> <a class="idref" href="Subst.html#x:104"><span class="id" title="variable">x</span></a>)) (<a class="idref" href="Term.html#freevars"><span class="id" title="definition">freevars</span></a> <a class="idref" href="Subst.html#z:103"><span class="id" title="variable">z</span></a>)) <a class="idref" href="Subst.html#env:101"><span class="id" title="variable">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Subst.html#m:99"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Subst.html#env':102"><span class="id" title="variable">env'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="Subst.html#n:100"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">∨</span></a> <a class="idref" href="Subst.html#n:100"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Subst.html#env:101"><span class="id" title="variable">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="Subst.html#m:99"><span class="id" title="variable">m</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#m:99"><span class="id" title="variable">m</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#n:100"><span class="id" title="variable">n</span></a> <a class="idref" href="Subst.html#env:101"><span class="id" title="variable">env</span></a>) <a class="idref" href="Subst.html#env':102"><span class="id" title="variable">env'</span></a>) (<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#n:100"><span class="id" title="variable">n</span></a> <a class="idref" href="Subst.html#env:101"><span class="id" title="variable">env</span></a> <a class="idref" href="Subst.html#N:98"><span class="id" title="variable">N</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#n:100"><span class="id" title="variable">n</span></a> <a class="idref" href="Subst.html#env:101"><span class="id" title="variable">env</span></a> (<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> <a class="idref" href="Subst.html#m:99"><span class="id" title="variable">m</span></a> <a class="idref" href="Subst.html#env':102"><span class="id" title="variable">env'</span></a> <a class="idref" href="Subst.html#N:98"><span class="id" title="variable">N</span></a>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="closing_subst_closes" class="idref" href="#closing_subst_closes"><span class="id" title="lemma">closing_subst_closes</span></a>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="vs:119" class="idref" href="#vs:119"><span class="id" title="binder">vs</span></a> <a id="ts:120" class="idref" href="#ts:120"><span class="id" title="binder">ts</span></a> <a id="m:121" class="idref" href="#m:121"><span class="id" title="binder">m</span></a> <a id="t:122" class="idref" href="#t:122"><span class="id" title="binder">t</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Term.html#env_typing"><span class="id" title="definition">env_typing</span></a> <a class="idref" href="Subst.html#vs:119"><span class="id" title="variable">vs</span></a> <a class="idref" href="Subst.html#ts:120"><span class="id" title="variable">ts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Term.html#Typing"><span class="id" title="inductive">Typing</span></a> <a class="idref" href="Subst.html#ts:120"><span class="id" title="variable">ts</span></a> <a class="idref" href="Subst.html#m:121"><span class="id" title="variable">m</span></a> <a class="idref" href="Subst.html#t:122"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Term.html#Typing"><span class="id" title="inductive">Typing</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> (<a class="idref" href="Subst.html#subst_env"><span class="id" title="definition">subst_env</span></a> 0 <a class="idref" href="Subst.html#vs:119"><span class="id" title="variable">vs</span></a> <a class="idref" href="Subst.html#m:121"><span class="id" title="variable">m</span></a>) <a class="idref" href="Subst.html#t:122"><span class="id" title="variable">t</span></a>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>